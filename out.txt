'use client';

import { FormEvent, useCallback, useEffect, useMemo, useState } from 'react';

import { useDashboard } from '../dashboard/DashboardContext';
import { useCatalogStyles } from '../catalog/catalog-ui';
import CatalogToast from '../catalog/CatalogToast';
import { useAuthFetch } from '@/hooks/useAuthFetch';
import { useFeedbackFlash } from '@/hooks/useFeedbackFlash';

interface Moneda {
  codigo: number;
  denominacion: string;
  tasa: number;
  simbolo: string;
}

interface DetalleEstado {
  monedaCodigo: number;
  denominacion: string;
  simbolo: string;
  tasa: number;
  cantidad: number;
}

interface CierreDetalleApi {
  aperturaCodigo: number;
  monedaCodigo: number;
  denominacion: string | null;
  simbolo: string | null;
  tasa: number | null;
  cantidad: number;
  monto: number;
}

interface CierreCajaApi {
  aperturaCodigo: number;
  fecha: string;
  monto: number;
  diferencia: number;
  cajaCodigo: number;
  cajaDescripcion: string;
  usuarioCodigo: number;
  usuarioUsername: string;
  usuarioNombre: string;
  usuarioApellido: string;
  montoApertura: number;
  saldoAnterior: number;
  totalCreditos: number;
  totalDebitos: number;
  detalles: CierreDetalleApi[];
}

interface ResumenDisponible {
  aperturaCodigo: number;
  cajaCodigo: number;
  cajaDescripcion: string;
  aperturaFecha: string;
  usuarioCodigo: number;
  usuarioUsername: string;
  usuarioNombre: string;
  usuarioApellido: string;
  montoApertura: number;
  saldoAnterior: number;
  totalCreditos: number;
  totalDebitos: number;
  saldoTeorico: number;
}

const numberFormatter = new Intl.NumberFormat('es-PY', {
  minimumFractionDigits: 0,
  maximumFractionDigits: 0,
});

const formatAmount = (value: number) => numberFormatter.format(Math.round(value));

const formatDate = (value: string) => {
  const [year, month, day] = value.split('-');
  if (!year || !month || !day) {
    return value;
  }
  return `${day}/${month}/${year}`;
};

const CierreCajaManager = () => {
  const { setPageTitle, theme } = useDashboard();
  const styles = useCatalogStyles(theme);
  const authFetch = useAuthFetch();
  const { feedback, showFeedback, clearFeedback } = useFeedbackFlash();

  const [loading, setLoading] = useState(false);
  const [saving, setSaving] = useState(false);
  const [monedas, setMonedas] = useState<Moneda[]>([]);
  const [detalles, setDetalles] = useState<DetalleEstado[]>([]);
  const [resumen, setResumen] = useState<ResumenDisponible | null>(null);
  const [cierres, setCierres] = useState<CierreCajaApi[]>([]);

  const totalContado = useMemo(
    () => detalles.reduce((acc, detalle) => acc + detalle.cantidad * detalle.tasa, 0),
    [detalles],
  );

  const saldoTeorico = resumen?.saldoTeorico ?? 0;
  const diferencia = totalContado - saldoTeorico;

  const detallesParaEnviar = useMemo(
    () =>
      detalles
        .filter((detalle) => detalle.cantidad >= 0)
        .map((detalle) => ({
          monedaCodigo: detalle.monedaCodigo,
          cantidad: detalle.cantidad,
        })),
    [detalles],
  );

  const formDeshabilitado = loading || saving || resumen === null || monedas.length === 0;
  const botonDeshabilitado =
    formDeshabilitado || detallesParaEnviar.length === 0 || !detallesParaEnviar.some((detalle) => detalle.cantidad > 0);

  const buildDetalleInicial = useCallback(
    (monedasDisponibles: Moneda[]) =>
      monedasDisponibles.map<DetalleEstado>((moneda) => ({
        monedaCodigo: moneda.codigo,
        denominacion: moneda.denominacion,
        simbolo: moneda.simbolo,
        tasa: moneda.tasa,
        cantidad: 0,
      })),
    [],
  );

  const fetchData = useCallback(async () => {
  setLoading(true);
  try {
    const monedasRes = await authFetch('/catalog/currencies');
    const monedasPayload = (await monedasRes.json()) as { monedas?: Moneda[] };
    const monedasLista = monedasPayload.monedas ?? [];
    setMonedas(monedasLista);
    setDetalles(buildDetalleInicial(monedasLista));
  } catch (error) {
    if (error instanceof Error) {
      showFeedback(error.message, 'error');
    } else {
      showFeedback('No se pudieron obtener las monedas configuradas.', 'error');
    }
    setLoading(false);
    return;
  }

  try {
    const resumenRes = await authFetch('/sales/cash-closings/available');
    const resumenData = (await resumenRes.json()) as ResumenDisponible;
    setResumen(resumenData);
  } catch (error) {
    setResumen(null);
    if (error instanceof Error) {
      const message = error.message;
      if (
        message.includes('No tienes una apertura de caja activa') ||
        message.includes('No hay una apertura activa')
      ) {
        // Estado esperado cuando no existe apertura activa despus del cierre.
      } else {
        showFeedback(message, 'error');
      }
    } else {
      showFeedback('No se pudo calcular el saldo teorico de la apertura.', 'error');
    }
  }

  try {
    const cierresRes = await authFetch('/sales/cash-closings?mine=true');
    const cierresPayload = (await cierresRes.json()) as { cierres?: CierreCajaApi[] };
    setCierres(cierresPayload.cierres ?? []);
  } catch (error) {
    if (error instanceof Error) {
      showFeedback(error.message, 'error');
    } else {
      showFeedback('No se pudo obtener el historial de cierres.', 'error');
    }
  } finally {
    setLoading(false);
  }
}, [authFetch, buildDetalleInicial, showFeedback]);

  useEffect(() => {
    setPageTitle('Cierre de caja');
    void fetchData();
  }, [fetchData, setPageTitle]);

  const handleCantidadChange = useCallback((monedaCodigo: number, value: number) => {
    setDetalles((prev) =>
      prev.map((detalle) =>
        detalle.monedaCodigo === monedaCodigo
          ? { ...detalle, cantidad: Number.isFinite(value) && value >= 0 ? value : 0 }
          : detalle,
      ),
    );
  }, []);

  const handleSubmit = useCallback(
    async (event: FormEvent<HTMLFormElement>) => {
      event.preventDefault();

      if (formDeshabilitado) {
        return;
      }

      if (!detallesParaEnviar.some((detalle) => detalle.cantidad > 0)) {
        showFeedback('Ingresa al menos una moneda con cantidad mayor a cero.', 'error');
        return;
      }

      setSaving(true);
      try {
        const response = await authFetch('/sales/cash-closings', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({
            detalles: detallesParaEnviar,
          }),
        });

        const payload = (await response.json().catch(() => ({}))) as { message?: string };

        if (!response.ok) {
          showFeedback(payload.message ?? 'No se pudo registrar el cierre.', 'error');
          return;
        }

        showFeedback('Cierre registrado correctamente.');
        await fetchData();
      } catch (error) {
        if (error instanceof Error) {
          showFeedback(error.message, 'error');
        } else {
          showFeedback('No se pudo registrar el cierre.', 'error');
        }
      } finally {
        setSaving(false);
      }
    },
    [authFetch, detallesParaEnviar, fetchData, formDeshabilitado, showFeedback],
  );

  const resolverEstadoDiferencia = (valor: number) => {
    if (Math.abs(valor) <= 0.5) {
      return 'Equilibrado';
    }
    return valor > 0 ? 'Sobrante' : 'Faltante';
  };

  const diferenciaEtiqueta = resolverEstadoDiferencia(diferencia);
  const diferenciaClass =
    Math.abs(diferencia) <= 0.5 ? 'text-slate-200' : diferencia > 0 ? 'text-emerald-400' : 'text-rose-400';

  return (
    <div className="p-5 sm:p-6">
      <CatalogToast feedback={feedback} theme={theme} onClose={clearFeedback} />
      <div className="mx-auto flex max-w-7xl flex-col gap-6">
        <section className={`${styles.panel} p-6`}>
          <div className="flex flex-col gap-3 md:flex-row md:items-center md:justify-between">
            <div>
              <h1 className={`text-xl font-semibold ${styles.heading}`}>Cierre de caja</h1>
              <p className={`text-sm ${styles.subheading}`}>
                Cuenta el efectivo disponible al finalizar la jornada y registra la diferencia contra el saldo teorico.
              </p>
            </div>
            {loading || saving ? (
              <span className="rounded-full border border-indigo-500/30 bg-indigo-500/10 px-4 py-1 text-xs font-medium text-indigo-300">
                {saving ? 'Guardando cambios-' : 'Cargando datos-'}
              </span>
            ) : null}
          </div>
          {resumen ? (
            <div className="mt-5 grid gap-4 md:grid-cols-2 lg:grid-cols-5">
              <div className={`${styles.mutedSurface} rounded-2xl px-4 py-3`}>
                <p className="text-xs uppercase tracking-wide text-slate-400">Caja</p>
                <p className={`text-sm font-semibold ${styles.textPrimary}`}>{resumen.cajaDescripcion}</p>
                <p className={`text-[11px] ${styles.textSecondary}`}>Apertura #{resumen.aperturaCodigo}</p>
              </div>
              <div className={`${styles.mutedSurface} rounded-2xl px-4 py-3`}>
                <p className="text-xs uppercase tracking-wide text-slate-400">Fecha de apertura</p>
                <p className={`text-sm font-semibold ${styles.textPrimary}`}>{formatDate(resumen.aperturaFecha)}</p>
              </div>
              <div className={`${styles.mutedSurface} rounded-2xl px-4 py-3`}>
                <p className="text-xs uppercase tracking-wide text-slate-400">Arrastre anterior</p>
                <p className="text-lg font-semibold text-slate-100">
                  {formatAmount(resumen.saldoAnterior)} Gs.
                </p>
              </div>
              <div className={`${styles.mutedSurface} rounded-2xl px-4 py-3`}>
                <p className="text-xs uppercase tracking-wide text-slate-400">Saldo teorico</p>
                <p className="text-lg font-semibold text-emerald-400">
                  {formatAmount(resumen.saldoTeorico)} Gs.
                </p>
              </div>
              <div className={`${styles.mutedSurface} rounded-2xl px-4 py-3`}>
                <p className="text-xs uppercase tracking-wide text-slate-400">Ingresos por credito</p>
                <p className={`text-sm font-semibold ${styles.textPrimary}`}>
                  {formatAmount(resumen.totalCreditos)} Gs.
                </p>
                <p className={`text-[11px] ${styles.textSecondary}`}>
                  Apertura {formatAmount(resumen.montoApertura)} Gs. - Arrastre {formatAmount(resumen.saldoAnterior)} Gs.
                </p>
              </div>
            </div>
          ) : (
            <div className="mt-5 rounded-2xl border border-amber-500/40 bg-amber-500/10 px-4 py-3 text-sm text-amber-200">
              No se detecto una apertura activa para cerrar. Crea una apertura o revisa el estado antes de registrar el cierre.
            </div>
          )`r`n        }`r`n        </section>

        <div className="grid gap-6 xl:grid-cols-[minmax(0,1fr)_minmax(0,1.2fr)]">
          <section className={`${styles.section} p-6`}>
            <div className="flex items-center justify-between">
              <h2 className={`text-sm font-semibold ${styles.heading}`}>Registrar cierre</h2>
              {resumen && resumen.totalDebitos > 0 ? (
                <span className="rounded-full border border-indigo-500/40 bg-indigo-500/10 px-3 py-1 text-[11px] font-semibold text-indigo-200">
                  Arqueo registrado: {formatAmount(resumen.totalDebitos)} Gs.
                </span>
              ) : null}
            </div>
            <p className={`mt-1 text-sm leading-relaxed ${styles.textSecondary}`}>
              Informa la cantidad de cada moneda contada en caja. El sistema calculara el total y almacenara la diferencia frente al saldo esperado.
            </p>

            <form className="mt-5 space-y-5" onSubmit={handleSubmit}>
              {monedas.length === 0 ? (
                <div className="rounded-xl border border-amber-500/40 bg-amber-500/10 px-4 py-3 text-xs text-amber-200">
                  Aun no se configuraron tipos de moneda. Crea al menos una moneda para poder registrar el cierre.
                </div>
              ) : (
                <div className="space-y-3">
                  <div className="flex items-center justify-between">
                    <span className={`text-sm font-semibold ${styles.textSecondary}`}>Detalle por moneda</span>
                    <span className="text-[11px] text-slate-400">
                      Los montos se calculan automaticamente segun la tasa configurada.
                    </span>
                  </div>
                  <div className="space-y-3">
                    {detalles.map((detalle) => {
                      const monto = detalle.cantidad * detalle.tasa;
                      return (
                        <div
                          key={detalle.monedaCodigo}
                          className="grid gap-3 rounded-xl border border-slate-800/60 bg-slate-950/40 p-3 md:grid-cols-[minmax(0,1fr)_120px_140px]"
                        >
                          <div className="flex flex-col text-xs text-slate-200">
                            <span className="font-semibold">{detalle.denominacion}</span>
                            <span className="text-[11px] text-slate-400">
                              Tasa: {formatAmount(detalle.tasa)} {detalle.simbolo || 'Gs.'}
                            </span>
                          </div>
                          <label className="flex items-center gap-2 text-xs text-slate-300">
                            Cantidad
                            <input
                              type="number"
                              min={0}
                              step={1}
                              value={detalle.cantidad}
                              onChange={(event) =>
                                handleCantidadChange(detalle.monedaCodigo, Number(event.target.value))
                              }
                              className={`${styles.input} w-full px-3 py-2`}
                              disabled={formDeshabilitado}
                            />
                          </label>
                          <div className="flex flex-col justify-center text-right text-xs font-semibold text-emerald-300">
                            <span>Monto</span>
                            <span>{formatAmount(monto)} Gs.</span>
                          </div>
                        </div>
                      );
                    })}
                  </div>
                </div>
              )}

              {resumen ? (
            <div className="mt-5 grid gap-4 md:grid-cols-2 lg:grid-cols-5">
              <div className={`${styles.mutedSurface} rounded-2xl px-4 py-3`}>
                <p className="text-xs uppercase tracking-wide text-slate-400">Caja</p>
                <p className={`text-sm font-semibold ${styles.textPrimary}`}>{resumen.cajaDescripcion}</p>
                <p className={`text-[11px] ${styles.textSecondary}`}>Apertura #{resumen.aperturaCodigo}</p>
              </div>
              <div className={`${styles.mutedSurface} rounded-2xl px-4 py-3`}>
                <p className="text-xs uppercase tracking-wide text-slate-400">Fecha de apertura</p>
                <p className={`text-sm font-semibold ${styles.textPrimary}`}>{formatDate(resumen.aperturaFecha)}</p>
              </div>
              <div className={`${styles.mutedSurface} rounded-2xl px-4 py-3`}>
                <p className="text-xs uppercase tracking-wide text-slate-400">Arrastre anterior</p>
                <p className="text-lg font-semibold text-slate-100">
                  {formatAmount(resumen.saldoAnterior)} Gs.
                </p>
              </div>
              <div className={`${styles.mutedSurface} rounded-2xl px-4 py-3`}>
                <p className="text-xs uppercase tracking-wide text-slate-400">Saldo teorico</p>
                <p className="text-lg font-semibold text-emerald-400">
                  {formatAmount(resumen.saldoTeorico)} Gs.
                </p>
              </div>
              <div className={`${styles.mutedSurface} rounded-2xl px-4 py-3`}>
                <p className="text-xs uppercase tracking-wide text-slate-400">Ingresos por credito</p>
                <p className={`text-sm font-semibold ${styles.textPrimary}`}>
                  {formatAmount(resumen.totalCreditos)} Gs.
                </p>
                <p className={`text-[11px] ${styles.textSecondary}`}>
                  Apertura {formatAmount(resumen.montoApertura)} Gs. - Arrastre {formatAmount(resumen.saldoAnterior)} Gs.
                </p>
              </div>
            </div>
          ) : (
            <div className="mt-5 rounded-2xl border border-amber-500/40 bg-amber-500/10 px-4 py-3 text-sm text-amber-200">
              No se detecto una apertura activa para cerrar. Crea una apertura o revisa el estado antes de registrar el cierre.
            </div>
          )}
        </section>

        <div className="grid gap-6 xl:grid-cols-[minmax(0,1fr)_minmax(0,1.2fr)]">
          <section className={`${styles.section} p-6`}>
            <div className="flex items-center justify-between">
              <h2 className={`text-sm font-semibold ${styles.heading}`}>Registrar cierre</h2>
              {resumen && resumen.totalDebitos > 0 ? (
                <span className="rounded-full border border-indigo-500/40 bg-indigo-500/10 px-3 py-1 text-[11px] font-semibold text-indigo-200">
                  Arqueo registrado: {formatAmount(Math.abs(resumen.totalDebitos))} Gs.
                </span>
              ) : null}
            </div>
            <p className={`mt-1 text-sm leading-relaxed ${styles.textSecondary}`}>
              Informa la cantidad de cada moneda contada en caja. El sistema calculara el total y almacenara la diferencia frente al saldo esperado.
            </p>

            <form className="mt-5 space-y-6" onSubmit={handleSubmit}>
              {monedas.length === 0 ? (
                <div className="rounded-xl border border-amber-500/40 bg-amber-500/10 px-4 py-3 text-xs text-amber-200">
                  Aun no se configuraron tipos de moneda. Crea al menos una moneda para poder registrar el cierre.
                </div>
              ) : (
                <div className="space-y-4">
                  <div className="flex items-center justify-between">
                    <span className={`text-sm font-semibold ${styles.textSecondary}`}>Detalle por moneda</span>
                    <span className="text-[11px] text-slate-400">
                      Los montos se calculan automaticamente segun la tasa configurada.
                    </span>
                  </div>
                  <div className="space-y-3">
                    {detalles.map((detalle) => {
                      const monto = detalle.cantidad * detalle.tasa;
                      return (
                        <div
                          key={detalle.monedaCodigo}
                          className="grid gap-3 rounded-xl border border-slate-800/60 bg-slate-950/40 p-3 md:grid-cols-[minmax(0,1fr)_120px_140px]"
                        >
                          <div className="flex flex-col text-xs text-slate-200">
                            <span className="font-semibold">{detalle.denominacion}</span>
                            <span className="text-[11px] text-slate-400">
                              Tasa: {formatAmount(detalle.tasa)} {detalle.simbolo || 'Gs.'}
                            </span>
                          </div>
                          <label className="flex items-center gap-2 text-xs text-slate-300">
                            Cantidad
                            <input
                              type="number"
                              min={0}
                              step={1}
                              value={detalle.cantidad}
                              onChange={(event) =>
                                handleCantidadChange(detalle.monedaCodigo, Number(event.target.value))
                              }
                              className={`${styles.input} w-full px-3 py-2`}
                              disabled={formDeshabilitado}
                            />
                          </label>
                          <div className="flex flex-col justify-center text-right text-xs font-semibold text-emerald-300">
                            <span>Monto</span>
                            <span>{formatAmount(monto)} Gs.</span>
                          </div>
                        </div>
                      );
                    })}
                  </div>
                </div>
              )}

              <div className="grid gap-3 rounded-2xl border border-slate-800/60 bg-slate-950/40 p-4 sm:grid-cols-3">
                <div className="flex flex-col gap-1 text-xs text-slate-300">
                  <span className="font-semibold uppercase tracking-wide text-slate-400">Total contado</span>
                  <span className="text-lg font-semibold text-emerald-300">{formatAmount(totalContado)} Gs.</span>
                </div>
                <div className="flex flex-col gap-1 text-xs text-slate-300">
                  <span className="font-semibold uppercase tracking-wide text-slate-400">Saldo teorico</span>
                  <span className="text-lg font-semibold text-emerald-300">{formatAmount(saldoTeorico)} Gs.</span>
                </div>
                <div className="flex flex-col gap-1 text-xs text-slate-300">
                  <span className="font-semibold uppercase tracking-wide text-slate-400">Diferencia</span>
                  <span className={`text-lg font-semibold ${diferenciaClass}`}>{formatAmount(diferencia)} Gs.</span>
                  <span className="text-[11px] text-slate-400">{diferenciaEtiqueta}</span>
                </div>
              </div>

              <div className="flex flex-col gap-3 pt-1 sm:flex-row sm:items-center sm:justify-between">
                <p className={`text-xs ${styles.textSecondary}`}>
                  {resumen
                    ? 'El arrastre se actualizara con la diferencia registrada en este cierre.'
                    : 'Necesitas una apertura activa para registrar el cierre.'}
                </p>
                <button
                  type="submit"
                  disabled={botonDeshabilitado}
                  className="inline-flex items-center justify-center rounded-xl bg-emerald-600 px-5 py-2 text-sm font-semibold text-white shadow-sm transition hover:bg-emerald-500 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:ring-offset-2 focus:ring-offset-slate-950 disabled:cursor-not-allowed disabled:bg-slate-800 disabled:text-slate-400"
                >
                  {saving ? 'Guardando...' : 'Registrar cierre'}
                </button>
              </div>
            </form>
          </section>

          <section className={`${styles.section} p-6`}>
            <div className="flex items-center justify-between">
              <h2 className={`text-sm font-semibold ${styles.heading}`}>Historial de cierres</h2>
              <span className="text-[11px] text-slate-400">
                {cierres.length} {cierres.length === 1 ? 'registro' : 'registros'}
              </span>
            </div>
            <div className="mt-4 space-y-4">
              {cierres.length === 0 ? (
                <div className="rounded-xl border border-slate-800/50 bg-slate-950/40 px-4 py-3 text-sm text-slate-300">
                  Aun no registraste cierres para esta caja.
                </div>
              ) : (
                cierres.map((cierre) => {
                  const diferenciaEstado = resolverEstadoDiferencia(cierre.diferencia);
                  const detalleDiferenciaClass =
                    Math.abs(cierre.diferencia) <= 0.5
                      ? 'text-slate-300'
                      : cierre.diferencia > 0
                        ? 'text-emerald-300'
                        : 'text-rose-300';
                  return (
                    <article
                      key={cierre.aperturaCodigo}
                      className="space-y-4 rounded-2xl border border-slate-800/60 bg-slate-950/30 p-4"
                    >
                      <div className="flex flex-col gap-2 md:flex-row md:items-center md:justify-between">
                        <div>
                          <p className="text-xs uppercase tracking-wide text-slate-400">
                            Cierre del {formatDate(cierre.fecha)} · Apertura #{cierre.aperturaCodigo}
                          </p>
                          <p className="text-sm font-semibold text-slate-100">{cierre.cajaDescripcion}</p>
                          <p className="text-[11px] text-slate-400">
                            Responsable {cierre.usuarioNombre} {cierre.usuarioApellido} · Diferencia{' '}
                            <span className={`font-semibold ${detalleDiferenciaClass}`}>
                              {formatAmount(cierre.diferencia)} Gs.
                            </span>{' '}
                            ({diferenciaEstado})
                          </p>
                        </div>
                        <div className="text-right">
                          <p className="text-xs text-slate-400">Total contado</p>
                          <p className="text-lg font-semibold text-emerald-300">{formatAmount(cierre.monto)} Gs.</p>
                        </div>
                      </div>

                      <div className="grid gap-2 text-[11px] text-slate-400 md:grid-cols-3">
                        <p>Apertura: {formatAmount(cierre.montoApertura)} Gs.</p>
                        <p>Arrastre: {formatAmount(cierre.saldoAnterior)} Gs.</p>
                        <p>
                          Ingresos: {formatAmount(cierre.totalCreditos)} Gs. · Egresos: {formatAmount(cierre.totalDebitos)} Gs.
                        </p>
                      </div>

                      {cierre.detalles.length === 0 ? (
                        <p className="text-xs text-slate-400">Sin detalle de monedas registrado.</p>
                      ) : (
                        <div className="overflow-auto">
                          <table className="w-full min-w-[260px] text-xs text-slate-300">
                            <thead>
                              <tr className="text-left text-[11px] uppercase tracking-wide text-slate-400">
                                <th className="px-2 py-1">Moneda</th>
                                <th className="px-2 py-1 text-right">Cantidad</th>
                                <th className="px-2 py-1 text-right">Monto</th>
                              </tr>
                            </thead>
                            <tbody className="divide-y divide-slate-800/50">
                              {cierre.detalles.map((detalle) => (
                                <tr key={`${detalle.aperturaCodigo}-${detalle.monedaCodigo}`}>
                                  <td className="px-2 py-1">{detalle.denominacion ?? 'General'}</td>
                                  <td className="px-2 py-1 text-right">{formatAmount(detalle.cantidad)}</td>
                                  <td className="px-2 py-1 text-right">{formatAmount(detalle.monto)} Gs.</td>
                                </tr>
                              ))}
                            </tbody>
                          </table>
                        </div>
                      )}
                    </article>
                  );
                })
              )}
            </div>
          </section>
        </div>
      </div>
    </div>
  );
};

export default CierreCajaManager;

